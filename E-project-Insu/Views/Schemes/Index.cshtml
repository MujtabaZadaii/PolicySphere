@model IEnumerable<E_project_Insu.Models.Scheme>

@{
    ViewData["Title"] = "Insurance Schemes";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Schemes Page - Professional Insurance Product Catalog -->
<div class="relative w-full min-h-screen bg-black text-white py-32 px-6">
    
    <!-- Header Section -->
    <div class="max-w-7xl mx-auto mb-20">
        <div class="text-center opacity-0 reveal-header">
            <span class="text-accent font-mono text-xs uppercase tracking-[0.2em] mb-4 inline-block">
                Available Coverage Plans
            </span>
            <h1 class="font-display font-bold text-5xl sm:text-7xl text-white mb-6 tracking-tight">
                Insurance <span class="text-accent">Schemes</span>
            </h1>
            <div class="h-px w-32 bg-accent/50 mx-auto mb-8"></div>
            <p class="text-gray-400 text-lg max-w-2xl mx-auto font-light leading-relaxed">
                Explore our comprehensive range of insurance schemes designed to protect what matters most. 
                Each plan is crafted with your security and peace of mind in focus.
            </p>
        </div>
    </div>

    <!-- Schemes Grid -->
    <div class="max-w-7xl mx-auto">
        @if (!Model.Any())
        {
            <div class="text-center py-20">
                <p class="text-gray-500 text-lg">No schemes available at the moment.</p>
            </div>
        }
        else
        {
            <!-- Group by Insurance Type -->
            @foreach (var type in Model.Select(s => s.InsuranceType).Distinct().OrderBy(t => t))
            {
                <div class="mb-20 opacity-0 reveal-section">
                    <!-- Type Header -->
                    <div class="flex items-center gap-4 mb-8">
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-accent/10 border border-accent/30 flex items-center justify-center">
                            @switch(type)
                            {
                                case "Life":
                                    <svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                                    break;
                                case "Medical":
                                    <svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                    break;
                                case "Motor":
                                    <svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                    break;
                                case "Home":
                                    <svg class="w-6 h-6 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                                    break;
                            }
                        </div>
                        <h2 class="font-display text-3xl font-bold text-white">@type Insurance</h2>
                    </div>

                    <!-- Schemes Cards for this Type -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        @foreach (var scheme in Model.Where(s => s.InsuranceType == type))
                        {
                            var schemeBg = scheme.ImageUrl;
                            if (string.IsNullOrEmpty(schemeBg))
                            {
                                if (scheme.InsuranceType.Contains("Life", StringComparison.OrdinalIgnoreCase)) { schemeBg = "/policy images/life policy.png"; }
                                else if (scheme.InsuranceType.Contains("Medical", StringComparison.OrdinalIgnoreCase)) { schemeBg = "/policy images/medical policy.jfif"; }
                                else if (scheme.InsuranceType.Contains("Motor", StringComparison.OrdinalIgnoreCase)) { schemeBg = "/policy images/MOTOR policy.jfif"; }
                                else if (scheme.InsuranceType.Contains("Home", StringComparison.OrdinalIgnoreCase)) { schemeBg = "/policy images/Home-Insurance.jpg"; }
                                else { schemeBg = "/policy images/life policy.png"; }
                            }

                            <div class="group bg-black/60 backdrop-blur-md border border-white/10 rounded-2xl p-8 hover:border-accent/50 transition-all duration-500 opacity-0 reveal-card relative overflow-hidden">
                                <!-- Background Image -->
                                <div class="absolute inset-0 bg-cover bg-center opacity-30 group-hover:scale-105 transition-transform duration-700" style="background-image: url('@schemeBg');"></div>
                                <!-- Gradient Overlay -->
                                <div class="absolute inset-0 bg-gradient-to-t from-black via-black/80 to-black/60"></div>

                                <div class="relative z-10">
                                    <!-- Scheme Name -->
                                    <h3 class="font-display text-2xl font-bold text-white mb-4 group-hover:text-accent transition-colors">
                                        @scheme.SchemeName
                                    </h3>
    
                                    <!-- Description -->
                                    <p class="text-gray-300 text-sm leading-relaxed mb-6 line-clamp-3">
                                        @scheme.Description
                                    </p>
    
                                    <!-- Eligibility Badge -->
                                    <div class="mb-6">
                                        <span class="text-xs uppercase tracking-wider text-gray-400 block mb-2">Eligibility</span>
                                        <p class="text-gray-200 text-sm font-light line-clamp-2">
                                            @scheme.Eligibility
                                        </p>
                                    </div>
    
                                    <!-- Actions -->
                                    <div class="flex items-center justify-between mt-auto pt-4 border-t border-white/20">
                                        <a href="@Url.Action("Details", "Schemes", new { id = scheme.SchemeId })" 
                                           class="text-gray-300 hover:text-white text-sm font-medium transition-colors">
                                            View Details
                                        </a>
                                        
                                        @if (!string.IsNullOrEmpty(Context.Session.GetString("Role")))
                                        {
                                            <a href="@Url.Action("ApplyScheme", "User", new { schemeId = scheme.SchemeId })" 
                                               class="px-5 py-2 bg-accent text-black font-bold text-sm rounded-full hover:bg-white hover:scale-105 transition-all shadow-[0_0_10px_rgba(172,88,233,0.3)]">
                                                Apply Now
                                            </a>
                                        }
                                        else
                                        {
                                            <a href="@Url.Action("Login", "Home")" 
                                               class="px-5 py-2 bg-white/10 text-white font-bold text-sm rounded-full hover:bg-accent hover:text-black hover:scale-105 transition-all border border-white/20">
                                                Login to Apply
                                            </a>
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }
        }
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Reveal animations
        gsap.to(".reveal-header", { opacity: 1, y: 0, duration: 1, ease: "power3.out" });
        
        gsap.utils.toArray(".reveal-section").forEach((section, i) => {
            gsap.to(section, {
                scrollTrigger: {
                    trigger: section,
                    start: "top 80%",
                },
                opacity: 1,
                y: 0,
                duration: 1,
                delay: i * 0.1,
                ease: "power3.out"
            });
        });

        gsap.utils.toArray(".reveal-card").forEach((card, i) => {
            gsap.to(card, {
                scrollTrigger: {
                    trigger: card,
                    start: "top 85%",
                },
                opacity: 1,
                y: 0,
                duration: 0.8,
                delay: (i % 3) * 0.1,
                ease: "power3.out"
            });
        });
    });
</script>
