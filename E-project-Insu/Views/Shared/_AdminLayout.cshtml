<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Admin Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        black: '#000000',
                        white: '#ffffff',
                        accent: '#AC58E9', 
                        darkbg: '#050505',
                        panel: '#0A0A0A',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        display: ['Oswald', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'blob': 'blob 7s infinite',
                        'swing': 'swing 2s infinite',
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        swing: {
                            '0%, 100%': { transform: 'rotate(0deg)' },
                            '20%': { transform: 'rotate(15deg)' },
                            '40%': { transform: 'rotate(-10deg)' },
                            '60%': { transform: 'rotate(5deg)' },
                            '80%': { transform: 'rotate(-5deg)' },
                        }
                    }
                }
            }
        }
        
        // Check local storage for theme
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark')
        } else {
            document.documentElement.classList.remove('dark')
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { transition: background-color 0.5s; }
        .sidebar-link.active { background-color: rgba(172, 88, 233, 0.1); color: #fff; border-right: 2px solid #AC58E9; }
        .sidebar-link:hover:not(.active) { background-color: rgba(255, 255, 255, 0.03); color: #fff; }
        
        /* Hide scrollbar for Chrome, Safari and Opera */
        ::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for IE, Edge and Firefox */
        body, html, main, aside, nav {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
    </style>
</head>
<body class="antialiased bg-gray-50 text-gray-900 dark:bg-black dark:text-gray-300 relative selection:bg-accent selection:text-white transition-colors duration-500">
    
    <!-- Global Dynamic Background Glow -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none opacity-0 dark:opacity-100 transition-opacity duration-700">
        <div class="glow-blob absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[60vw] h-[60vw] bg-accent/20 rounded-full blur-[120px] opacity-50 mix-blend-screen animate-blob"></div>
        <div class="glow-blob-2 absolute top-1/4 left-3/4 w-[30vw] h-[30vw] bg-purple-900/30 rounded-full blur-[80px] opacity-40 mix-blend-screen animate-pulse-slow"></div>
    </div>

    <!-- Dynamic Background Glow -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <div class="glow-blob absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[60vw] h-[60vw] bg-accent/10 rounded-full blur-[120px] opacity-40 mix-blend-screen animate-blob"></div>
    </div>

    <div class="min-h-screen relative z-10 flex flex-col">
        
        <!-- Top Navigation Bar (Crextio Style) -->
        <header class="w-full px-8 py-6 flex items-center justify-between">
            
            <!-- Logo (Left) -->
            <div class="w-48">
                <div class="flex items-center gap-3">
                    <img src="~/logo/navbar logo.png" class="h-10 w-auto" alt="PolicySphere" />
                </div>
            </div>

            <!-- Central Pill Navigation (Floating) -->
            <nav class="hidden lg:flex items-center gap-1 bg-[#111]/80 backdrop-blur-xl border border-white/10 px-2 py-2 rounded-full shadow-2xl">
                <a asp-controller="Admin" asp-action="Dashboard" class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Dashboard" ? "bg-black text-white shadow-lg" : "text-gray-400 hover:text-white hover:bg-white/5")">
                    Dashboard
                </a>
                <a asp-controller="Admin" asp-action="Users" class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Users" ? "bg-black text-white shadow-lg" : "text-gray-400 hover:text-white hover:bg-white/5")">
                    Users
                </a>
                <a asp-controller="Admin" asp-action="Policies" class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Policies" ? "bg-black text-white shadow-lg" : "text-gray-400 hover:text-white hover:bg-white/5")">
                    Policies
                </a>
                <a asp-controller="Admin" asp-action="Schemes" class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Schemes" ? "bg-black text-white shadow-lg" : "text-gray-400 hover:text-white hover:bg-white/5")">
                    Schemes
                </a>
                <a asp-controller="Admin" asp-action="Loans" class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Loans" ? "bg-black text-white shadow-lg" : "text-gray-400 hover:text-white hover:bg-white/5")">
                    Loans
                </a>
                <a asp-controller="Admin" asp-action="Payments" class="px-6 py-2.5 rounded-full text-sm font-medium transition-all duration-300 @(ViewContext.RouteData.Values["Action"]?.ToString() == "Payments" ? "bg-black text-white shadow-lg" : "text-gray-400 hover:text-white hover:bg-white/5")">
                    Payments
                </a>
                
                <!-- Updates Dropdown -->
                <div class="relative group">
                    <button class="px-6 py-2.5 rounded-full text-sm font-medium text-gray-400 hover:text-white hover:bg-white/5 flex items-center gap-2 transition-all duration-300 @( (ViewContext.RouteData.Values["Action"]?.ToString() == "Insights" || ViewContext.RouteData.Values["Action"]?.ToString() == "Inquiries") ? "bg-black text-white shadow-lg" : "")">
                        Updates
                        <svg class="w-3 h-3 text-gray-500 group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <!-- Dropdown Menu -->
                    <div class="absolute top-full right-0 mt-2 w-48 bg-[#0a0a0a] border border-white/10 rounded-2xl overflow-hidden invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all duration-300 transform origin-top -translate-y-2 group-hover:translate-y-0 shadow-2xl z-50">
                        <a asp-controller="Admin" asp-action="ContentManager" class="block px-5 py-3 text-sm text-gray-400 hover:text-white hover:bg-white/5 border-b border-white/5 transition-colors">
                            Content Manager
                        </a>
                        <a asp-controller="Admin" asp-action="Insights" class="block px-5 py-3 text-sm text-gray-400 hover:text-white hover:bg-white/5 border-b border-white/5 transition-colors">
                            Insights
                        </a>
                        <a asp-controller="Admin" asp-action="Inquiries" class="block px-5 py-3 text-sm text-gray-400 hover:text-white hover:bg-white/5 transition-colors">
                            Inquiries
                        </a>
                    </div>
                </div>
            </nav>

            <!-- Right Utilities (Settings, Notification, Profile) -->
            <div class="w-auto flex items-center justify-end gap-3">
                

                <!-- Notifications Pill -->
                <a asp-controller="Admin" asp-action="Notifications" class="flex items-center gap-2 px-5 py-2.5 rounded-full bg-white border border-gray-200 dark:bg-[#111]/80 dark:border-white/10 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-white/10 transition-colors relative group">
                    <svg class="w-5 h-5 group-hover:swing" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                    <span class="text-sm font-medium">Alerts</span>
                    @{
                        var _dbContext = Context.RequestServices.GetService(typeof(E_project_Insu.Data.ApplicationDbContext)) as E_project_Insu.Data.ApplicationDbContext;
                        var notifCount = _dbContext?.Notifications.Count(n => !n.IsRead) ?? 0;
                    }
                    @if(notifCount > 0){
                        <span class="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border border-black shadow-[0_0_8px_rgba(239,68,68,0.6)]"></span>
                    }
                </a>

                <!-- Profile Dropdown (Website Style) -->
                <div class="relative group z-50">
                    <!-- Trigger -->
                    <button class="flex items-center gap-4 focus:outline-none py-2">
                        <div class="hidden xl:flex flex-col items-end">
                            <span class="font-display text-lg text-gray-800 dark:text-white leading-none tracking-wide group-hover:text-accent transition-colors duration-300">Admin</span>
                            <span class="text-[10px] uppercase tracking-[0.2em] text-gray-500 group-hover:text-gray-900 dark:group-hover:text-white/60 transition-colors">Administrator</span>
                        </div>
                        
                        <!-- Avatar Container -->
                        <div class="relative w-12 h-12">
                            <div class="absolute inset-0 bg-accent/40 rounded-full blur-md opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
                            <div class="relative w-full h-full rounded-full bg-gray-200 dark:bg-[#111] border border-gray-300 dark:border-white/20 flex items-center justify-center text-gray-800 dark:text-white font-serif italic text-xl shadow-inner group-hover:border-accent transition-colors duration-300 overflow-hidden">
                                    <div class="absolute inset-0 bg-gradient-to-tr from-accent/20 to-transparent opacity-50"></div>
                                    <span class="relative z-10">A</span>
                            </div>
                            <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-black"></div>
                        </div>
                    </button>
                    
                     <!-- Dropdown Panel -->
                    <div class="absolute right-0 mt-4 w-80 bg-white dark:bg-[#050505] border border-gray-200 dark:border-white/10 rounded-2xl shadow-[0_20px_60px_rgba(0,0,0,0.1)] dark:shadow-[0_20px_60px_rgba(0,0,0,0.8)] overflow-hidden transform origin-top-right transition-all duration-300 opacity-0 invisible translate-y-4 group-hover:opacity-100 group-hover:visible group-hover:translate-y-0 backdrop-blur-3xl">
                        <div class="relative p-6 border-b border-gray-100 dark:border-white/5 bg-gray-50 dark:bg-white/[0.02]">
                            <p class="text-gray-900 dark:text-white font-display text-xl truncate pr-4">admin@policysphere.com</p>
                            <div class="mt-3 flex items-center gap-2">
                                <span class="px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-accent/10 text-accent border border-accent/20">Admin Member</span>
                            </div>
                        </div>
                        <div class="p-2 space-y-1">
                                <a asp-controller="Admin" asp-action="Dashboard" class="flex items-center justify-between px-4 py-3 rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-white/5 transition-all">
                                <span class="font-medium">Admin Dashboard</span>
                                </a>
                            <a asp-controller="Admin" asp-action="Settings" class="flex items-center justify-between px-4 py-3 rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-white/5 transition-all">
                                <span class="font-medium">Settings</span>
                            </a>
                            <a asp-controller="Admin" asp-action="Notifications" class="flex items-center justify-between px-4 py-3 rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-white/5 transition-all">
                                <span class="font-medium">Notifications</span>
                            </a>
                        </div>
                        <div class="p-2 border-t border-gray-100 dark:border-white/5">
                            <a asp-controller="Admin" asp-action="Logout" class="flex items-center justify-between px-4 py-3 rounded-xl text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-500/10 transition-all">
                                <span class="font-medium">Sign Out</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto w-full max-w-[1920px] mx-auto">
            @RenderBody()
        </main>
    </div>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer></script>
    @await RenderSectionAsync("Scripts", required: false)
    
    <script>
        // Ensure page always loads from top
        window.addEventListener('beforeunload', function() {
            window.scrollTo(0, 0);
        });
        
        window.addEventListener('load', function() {
            setTimeout(function() {
                window.scrollTo(0, 0);
            }, 0);
        });
        
        // Also reset on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', function() {
            window.scrollTo(0, 0);
        });
        
        // Immediate scroll to top
        if (history.scrollRestoration) {
            history.scrollRestoration = 'manual';
        }
        window.scrollTo(0, 0);
    </script>
    

</body>
</html>
